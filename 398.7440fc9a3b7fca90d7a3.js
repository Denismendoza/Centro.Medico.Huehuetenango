"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[398],{7398:(ft,N,o)=>{o.r(N),o.d(N,{PatientsModule:()=>gt});var x=o(6627),O=o(3935),v=o(1494),q=o(4466),I=o(9983),F=o(2458),_=o(1095),J=o(7441),d=o(2238),U=o(1436),R=o(7539),Z=o(9692),T=o(8295),D=o(3423),b=o(9765),S=o(4762),k=o(3752),l=o(3679),c=o(6782),t=o(7716),m=o(8002),g=o(5304),L=o(2340),Q=o(1841),z=o(6215),f=o(5917);const h=L.N.API_URL;let P=(()=>{class i{constructor(e){this._http=e,this._dialog=new b.xQ,this._patients=new z.X([])}dialogOpened(){this._dialog.next()}get patients$(){return this._patients.asObservable()}get dialog$(){return this._dialog.asObservable()}findPatientsPaginated(e=1,n=10){const a=(new Q.LE).append("page",e).append("pageSize",n);return this._http.get(`${h}patient/findPaginated`,{params:a}).pipe((0,m.U)(s=>(this._patients.next(s.data),s)),(0,g.K)(s=>(0,f.of)(null)))}findPatient(e){return this._http.get(`${h}patient/findById/${e}`).pipe((0,m.U)(n=>n),(0,g.K)(n=>(0,f.of)(null)))}createPatient(e){return this._http.post(`${h}patient/create`,e).pipe((0,m.U)(n=>null==n?void 0:n.stored),(0,g.K)(n=>(0,f.of)(!1)))}updatePatient(e){return this._http.put(`${h}patient/update`,e).pipe((0,m.U)(n=>null==n?void 0:n.updated),(0,g.K)(n=>(0,f.of)(!1)))}deletePatient(e){return this._http.delete(`${h}patient/delete/${e}`).pipe((0,m.U)(n=>null==n?void 0:n.deleted),(0,g.K)(n=>(0,f.of)(!1)))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Q.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var w=o(2138),u=o(8583);function $(i,r){1&i&&(t.TgZ(0,"h2",11),t._uU(1,"Editar paciente"),t.qZA())}function M(i,r){1&i&&(t.TgZ(0,"h2",11),t._uU(1,"Datos de paciente"),t.qZA())}function H(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido. "),t.qZA())}function B(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido. "),t.qZA())}function K(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido. "),t.qZA())}function j(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido y debe ser un correo electr\xf3nico v\xe1lido. "),t.qZA())}function G(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido. "),t.qZA())}function V(i,r){if(1&i&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.key)}}function W(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Este campo es requerido. "),t.qZA())}function X(i,r){if(1&i&&(t.TgZ(0,"mat-form-field"),t.TgZ(1,"mat-select",12),t.YNc(2,V,2,2,"mat-option",13),t.qZA(),t.YNc(3,W,2,0,"mat-error",3),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.states),t.xp6(1),t.Q6J("ngIf",e.Form.get("isEnabled").invalid&&e.Form.get("isEnabled").touched)}}function tt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().onCreatePatient()}),t._uU(1," Crear paciente "),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("color","primary")("disabled",e.Form.invalid||e.Form.pristine)}}function et(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().onEditPatient()}),t._uU(1," Actualizar paciente "),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("color","primary")("disabled",e.Form.invalid||e.Form.pristine)}}let E=(()=>{class i{constructor(e,n,a,s,p){this._fb=e,this._service=n,this._snackbar=a,this.data=s,this.dialogRef=p,this.roles=[...k.K],this.states=[...k.t],this._unsubscribe=new b.xQ}ngOnInit(){this._initForm()}ngOnDestroy(){this._unsubscribe.next(),this._unsubscribe.complete()}_initForm(){var e,n,a,s,p,y,C,A;this.Form=this._fb.group({id:[null===(e=null==this?void 0:this.data)||void 0===e?void 0:e.id],password:[null,[l.kI.required]],email:[null===(n=null==this?void 0:this.data)||void 0===n?void 0:n.email,[l.kI.required]],lastName:[null===(a=null==this?void 0:this.data)||void 0===a?void 0:a.lastName,[l.kI.required]],firstName:[null===(s=null==this?void 0:this.data)||void 0===s?void 0:s.firstName,[l.kI.required]],displayName:[null===(p=null==this?void 0:this.data)||void 0===p?void 0:p.displayName,[l.kI.required]],isEnabled:[+(null===(y=null==this?void 0:this.data)||void 0===y?void 0:y.isEnabled)||0,[l.kI.required]]}),this.data&&(null===(A=null===(C=this.Form.controls)||void 0===C?void 0:C.password)||void 0===A||A.clearValidators())}onCreatePatient(){if(this.Form.invalid)return Object.values(this.Form.controls).forEach(e=>e.markAsTouched());this._service.createPatient(this.Form.getRawValue()).pipe((0,c.R)(this._unsubscribe)).subscribe(e=>{this._snackbar.open(e?"El paciente se ha creado exit\xf3samente.":"Ha ocurrido un error al crear el paciente."),e&&this.onCancel()})}onEditPatient(){if(this.Form.invalid)return Object.values(this.Form.controls).forEach(n=>n.markAsTouched());const e=(0,S._T)(this.Form.getRawValue(),[]);this._service.updatePatient(e).pipe((0,c.R)(this._unsubscribe)).subscribe(n=>{this._snackbar.open(n?"El paciente se ha actualizado exit\xf3samente.":"Ha ocurrido un error al actualizar el paciente."),n&&this.onCancel()})}onKeyDown(e){"Space"===e.code&&e.preventDefault()}onCancel(){this.dialogRef.close()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(l.qu),t.Y36(P),t.Y36(w.o),t.Y36(d.WI),t.Y36(d.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-patient-detail"]],decls:24,vars:11,consts:[["mat-dialog-title","",4,"ngIf"],["name","Form",3,"formGroup"],["matInput","","placeholder","Nombre","formControlName","firstName",3,"keydown"],[4,"ngIf"],["matInput","","placeholder","Apellido","formControlName","lastName",3,"keydown"],["matInput","","placeholder","Nombre de usuario","formControlName","displayName"],["matInput","","placeholder","Email","formControlName","email",3,"keydown"],["matInput","","type","password","placeholder","Contrase\xf1a","formControlName","password"],["mat-dialog-actions",""],["mat-button","","type","button",3,"click"],["mat-flat-button","",3,"color","disabled","click",4,"ngIf"],["mat-dialog-title",""],["placeholder","Estado","formControlName","isEnabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-flat-button","",3,"color","disabled","click"]],template:function(e,n){1&e&&(t.YNc(0,$,2,0,"h2",0),t.YNc(1,M,2,0,"h2",0),t.TgZ(2,"form",1),t.TgZ(3,"mat-form-field"),t.TgZ(4,"input",2),t.NdJ("keydown",function(s){return n.onKeyDown(s)}),t.qZA(),t.YNc(5,H,2,0,"mat-error",3),t.qZA(),t.TgZ(6,"mat-form-field"),t.TgZ(7,"input",4),t.NdJ("keydown",function(s){return n.onKeyDown(s)}),t.qZA(),t.YNc(8,B,2,0,"mat-error",3),t.qZA(),t.TgZ(9,"mat-form-field"),t._UZ(10,"input",5),t.YNc(11,K,2,0,"mat-error",3),t.qZA(),t.TgZ(12,"mat-form-field"),t.TgZ(13,"input",6),t.NdJ("keydown",function(s){return n.onKeyDown(s)}),t.qZA(),t.YNc(14,j,2,0,"mat-error",3),t.qZA(),t.TgZ(15,"mat-form-field"),t._UZ(16,"input",7),t.YNc(17,G,2,0,"mat-error",3),t.qZA(),t.YNc(18,X,4,2,"mat-form-field",3),t.TgZ(19,"div",8),t.TgZ(20,"button",9),t.NdJ("click",function(){return n.onCancel()}),t._uU(21,"Cancelar"),t.qZA(),t.YNc(22,tt,2,2,"button",10),t.YNc(23,et,2,2,"button",10),t.qZA(),t.qZA()),2&e&&(t.Q6J("ngIf",n.data),t.xp6(1),t.Q6J("ngIf",!n.data),t.xp6(1),t.Q6J("formGroup",n.Form),t.xp6(3),t.Q6J("ngIf",n.Form.get("firstName").invalid&&n.Form.get("firstName").touched),t.xp6(3),t.Q6J("ngIf",n.Form.get("lastName").invalid&&n.Form.get("lastName").touched),t.xp6(3),t.Q6J("ngIf",n.Form.get("displayName").invalid&&n.Form.get("displayName").touched),t.xp6(3),t.Q6J("ngIf",n.Form.get("email").invalid&&n.Form.get("email").touched),t.xp6(3),t.Q6J("ngIf",n.Form.get("password").invalid&&n.Form.get("password").touched),t.xp6(1),t.Q6J("ngIf",n.data),t.xp6(4),t.Q6J("ngIf",!n.data),t.xp6(1),t.Q6J("ngIf",n.data))},directives:[u.O5,l._Y,l.JL,l.sg,T.KE,I.Nt,l.Fj,l.JJ,l.u,d.H8,_.lW,d.uh,T.TO,J.gD,u.sg,F.ey],styles:[".mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:10px;display:grid!important}"]}),i})();var it=o(1452),nt=o(6682),ot=o(3190);function at(i,r){1&i&&t._UZ(0,"mat-icon",15),2&i&&t.Q6J("matTooltip","Inhabilitado")}function rt(i,r){1&i&&t._UZ(0,"mat-icon",16),2&i&&t.Q6J("matTooltip","Habilitado")}function st(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",7),t.TgZ(2,"div",8),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA(),t.TgZ(6,"div",8),t.YNc(7,at,1,1,"mat-icon",9),t.YNc(8,rt,1,1,"mat-icon",10),t.qZA(),t.TgZ(9,"div",8),t.TgZ(10,"button",11),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).editPatient(s)}),t._UZ(11,"mat-icon",12),t.qZA(),t.TgZ(12,"button",13),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deletePatient(s.id)}),t._UZ(13,"mat-icon",14),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&i){const e=r.$implicit;t.xp6(3),t.hij(" ",null==e?null:e.displayName," "),t.xp6(2),t.hij(" ",null==e?null:e.email," "),t.xp6(2),t.Q6J("ngIf",0==+(null==e?null:e.isEnabled)),t.xp6(1),t.Q6J("ngIf",1==+(null==e?null:e.isEnabled)),t.xp6(2),t.Q6J("matTooltip","Editar paciente"),t.xp6(2),t.Q6J("matTooltip","Inhabilitar paciente")}}function lt(i,r){if(1&i&&(t.ynx(0),t.YNc(1,st,14,6,"ng-container",6),t.BQk()),2&i){const e=r.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",n.trackByFn)}}const ct=function(i){return{"pointer-events-none":i}};let dt=(()=>{class i{constructor(e,n,a,s){this._dialog=e,this._service=n,this._snackbar=a,this._changeDetectorRef=s,this.patients=[],this.loading=!1,this._unsubscribe=new b.xQ,this.page=1,this.pages=0,this.count=0,this.pageSize=10,this.pageSizeOptions=[10,15,25]}ngOnInit(){this._findPatients(),this._onListenDialog()}ngAfterViewInit(){this.sort&&this.paginator&&(this.sort.sort({start:"asc",id:"displayName",disableClear:!0}),this._changeDetectorRef.markForCheck(),(0,nt.T)(this.sort.sortChange,this.paginator.page).pipe((0,ot.w)(()=>(this.loading=!0,this.pageSize=this.paginator.pageSize,this._service.findPatientsPaginated(this.paginator.pageIndex+1,this.paginator.pageSize))),(0,m.U)(()=>this.loading=!1)).pipe((0,c.R)(this._unsubscribe)).subscribe())}ngOnDestroy(){this._unsubscribe.next(),this._unsubscribe.complete()}deletePatient(e){this._service.deletePatient(e).pipe((0,c.R)(this._unsubscribe)).subscribe(n=>{this._snackbar.open(n?"Se ha inhabilitado el paciente de manera exit\xf3sa.":"Ha ocurrido un error al inhabilitar el paciente."),n&&this._findPatients(this.paginator.pageIndex+1,this.paginator.pageSize)})}editPatient(e){this._dialog.open(E,{width:"500px",data:e}).afterClosed().pipe((0,c.R)(this._unsubscribe)).subscribe(a=>{this._findPatients(this.paginator.pageIndex+1,this.paginator.pageSize)})}_findPatients(e=1,n=10){this.loading=!0,this._service.findPatientsPaginated(e,n).pipe((0,c.R)(this._unsubscribe)).subscribe(a=>{this.patients=null==a?void 0:a.data,this.count=null==a?void 0:a.count},()=>{this._snackbar.open("Ha ocurrido un error al obtener los pacientes.")},()=>{this.loading=!1}),this.patients$=this._service.patients$}_onListenDialog(){this._service.dialog$.pipe((0,c.R)(this._unsubscribe)).subscribe(e=>{this._findPatients(this.paginator.pageIndex+1,this.paginator.pageSize)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.uw),t.Y36(P),t.Y36(w.o),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["patient-log"]],viewQuery:function(e,n){if(1&e&&(t.Gf(v.YE,5),t.Gf(Z.NW,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.sort=a.first),t.iGM(a=t.CRH())&&(n.paginator=a.first)}},decls:14,vars:9,consts:[[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-patient-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"hidden","sm:block"],[4,"ngIf"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"length","pageSizeOptions","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inventory-patient-grid","inventory-patient-row-grid","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b"],[1,"truncate"],["style","color: red","svgIcon","heroicons_outline:x-circle",3,"matTooltip",4,"ngIf"],["style","color: green","svgIcon","heroicons_outline:check-circle",3,"matTooltip",4,"ngIf"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"matTooltip","click"],["svgIcon","heroicons_outline:pencil-alt"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6","ml-2",3,"matTooltip","click"],["svgIcon","heroicons_outline:user-remove"],["svgIcon","heroicons_outline:x-circle",2,"color","red",3,"matTooltip"],["svgIcon","heroicons_outline:check-circle",2,"color","green",3,"matTooltip"]],template:function(e,n){1&e&&(t.ynx(0),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t._uU(4,"Nombre"),t.qZA(),t.TgZ(5,"div",3),t._uU(6,"Email"),t.qZA(),t.TgZ(7,"div",3),t._uU(8,"Estado"),t.qZA(),t.TgZ(9,"div",3),t._uU(10,"Opciones"),t.qZA(),t.qZA(),t.qZA(),t.YNc(11,lt,2,2,"ng-container",4),t.ALo(12,"async"),t._UZ(13,"mat-paginator",5),t.BQk()),2&e&&(t.xp6(3),t.Q6J("mat-sort-header","name"),t.xp6(8),t.Q6J("ngIf",t.lcZ(12,5,n.patients$)),t.xp6(2),t.Q6J("length",n.count)("pageSizeOptions",n.pageSizeOptions)("ngClass",t.VKq(7,ct,n.loading)))},directives:[v.YE,v.nU,u.O5,Z.NW,u.mk,u.sg,_.lW,U.gM,x.Hw],pipes:[u.Ov],styles:[".inventory-patient-grid{grid-template-columns:auto 40px}@media (min-width: 600px){.inventory-patient-grid{grid-template-columns:295px 236px 150px 72px}}@media (min-width: 960px){.inventory-patient-grid{grid-template-columns:112px auto 112px 72px}}@media (min-width: 1280px){.inventory-patient-grid{grid-template-columns:349px auto 112px 180px}}.inventory-patient-row-grid{height:70px}\n"],encapsulation:2,data:{animation:it.L},changeDetection:0}),i})();const pt=[{path:"",component:(()=>{class i{constructor(e,n){this._dialog=e,this._service=n,this._unsubscribe=new b.xQ}ngOnInit(){}ngOnDestroy(){this._unsubscribe.next(),this._unsubscribe.complete()}createPatient(){this._dialog.open(E,{width:"500px"}).afterClosed().pipe((0,c.R)(this._unsubscribe)).subscribe(n=>this._service.dialogOpened())}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.uw),t.Y36(P))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-patients"]],decls:12,vars:2,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-flat-button","",1,"ml-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Pacientes"),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"button",4),t.NdJ("click",function(){return n.createPatient()}),t._UZ(6,"mat-icon",5),t.TgZ(7,"span",6),t._uU(8,"Agregar"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",7),t.TgZ(10,"div",8),t._UZ(11,"patient-log"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"))},directives:[_.lW,x.Hw,dt],styles:[""]}),i})()}];let mt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[D.Bz.forChild(pt)],D.Bz]}),i})();var ut=o(2178),Y=o(5396);let gt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[mt,q.m,x.Ps,O.Tx,v.JX,I.c,J.LD,_.ot,F.si,d.Is,U.AV,R.p9,Z.TU,T.lN,ut.Cv,Y.rP,Y.rP]]}),i})()}}]);